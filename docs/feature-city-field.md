# Руководство: Поле "Город"

## 1. Обзор

Для улучшения структуризации данных о расходах в приложение было добавлено отдельное поле `city`. Это позволяет автоматически извлекать и хранить информацию о городе, в котором была совершена транзакция.

## 2. Автоматическое извлечение из выписок

Ключевой особенностью является способность системы автоматически находить и извлекать название города напрямую из описания транзакции в банковских выписках.

### Как это работает:
*   **Парсер**: Специальная утилита (`extractCityFromDescription`) анализирует текстовое описание каждой транзакции.
*   **База городов**: Парсер ищет совпадения с заранее определенным списком городов (например, `MINSK`, `LOGOYSK` и т.д.).
*   **Интеллектуальный анализ**: Используются различные паттерны для поиска города, даже если он находится в середине строки или в нестандартном формате (например, `BY SUPERMARKET LOGOYSK` или `...FACTORY, MINSK`).
*   **Очистка описания**: В случае успешного извлечения (с высоким уровнем уверенности), название города удаляется из основного описания транзакции. Это делает описание более чистым и улучшает точность автоматической категоризации.

## 3. Техническая реализация

### База данных
*   В таблицу `expenses` добавлено поле `city` типа `VARCHAR(100)`.
*   Поле индексировано для обеспечения быстрого поиска и фильтрации по городу.

### Пользовательский интерфейс
*   **Массовый ввод**: В таблице массового ввода город отображается в отдельной колонке. Пользователи могут видеть автоматически извлеченный город и при необходимости редактировать его вручную.
*   **Отображение**: На главной странице расходов город также выводится в отдельной колонке, обеспечивая наглядность.

### Хранение данных
Ранее извлеченный город сохранялся в поле "Примечания". Теперь он сохраняется в своем собственном структурированном поле `city`, что делает данные более чистыми и готовыми для будущей аналитики (например, отчеты по расходам в разных городах).
